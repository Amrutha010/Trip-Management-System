{% extends "base.html" %}
{% block title %}Agent sign up{% endblock %}
{% block content %}
<div class="center">
  <div class="auth-card card">
    <h2 style="margin-top:0">Agent registration</h2>
    <p class="small muted">Create an agent account â€” admin approval required. (Access only via onboarding URL)</p>

    <form class="form" method="post" action="{{ url_for('agent_onboard', token=token) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div>
        <label for="username">Agent username</label>
        <input id="username" name="username" type="text" required>
      </div>
      <div style="margin-top:10px;">
        <label for="password">Password</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <input id="password" name="password" type="password" required style="flex:1;">
          <button id="toggle-agent-password" type="button" class="btn secondary" style="padding:6px 8px;">Show</button>
        </div>
      </div>

      <div style="margin-top:14px; display:flex; justify-content:space-between; align-items:center;">
        <button class="btn" type="submit">Request approval</button>
        <a class="small muted" href="{{ url_for('login') }}">Back to login</a>
      </div>
    </form>
  </div>
</div>

<script>
  (function(){
    const pwd = document.getElementById('password');
    const btn = document.getElementById('toggle-agent-password');
    if (!pwd || !btn) return;
    btn.addEventListener('click', function(){
      if (pwd.type === 'password') {
        pwd.type = 'text'; btn.textContent = 'Hide';
      } else {
        pwd.type = 'password'; btn.textContent = 'Show';
      }
    });
  })();
</script>
{% endblock %}